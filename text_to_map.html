<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

  <style type="text/css">
    html { height: 100% }
    body { height: 100%; margin: 0; padding: 0 }
    #map_canvas { width:100%; height: 200px; background-color:#e7e7e7;}
  </style>

  <!-- Google Maps APIを読み込む -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDEG16WeMaOoAtxtKMfp0YUEM2S2CTksh0"
  type="text/javascript">
  
</script>

<!-- initialize()関数を定義 -->
<script type="text/javascript">
  function initialize() {
        // 地図を表示する際のオプションを設定
        var mapOptions = {
          center: new google.maps.LatLng(35.681167, 139.767052),
          zoom: 12,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        // Mapオブジェクトに地図表示要素情報とオプション情報を渡し、インスタンス生成
        var map = new google.maps.Map(document.getElementById("map_canvas"),
          mapOptions);
      }
    </script>
  </head>

  <!-- ページが読み込まれたらinitialize()関数を実行 -->
  <body onload="initialize()">
    <!-- 地図を表示させる要素。widthとheightを必ず指定する。 -->
    <!--<div id="map_canvas" style="width:100%; height:100%"></div>-->

    <form>
      <input type="text" value="東京スカイツリー" id="address">
      <input type="button" value="地図検索" id="button">
      <script>
       var getMap = (function() {

         function codeAddress(address) {

           // google.maps.Geocoder()コンストラクタのインスタンスを生成
           var geocoder = new google.maps.Geocoder();


           // 地図表示に関するオプション
           var mapOptions = {
             zoom: 18,
             mapTypeId: google.maps.MapTypeId.ROADMAP,
             // マウスホイールによるズーム操作を無効
             scrollwheel: false
           };

           // 地図を表示させるインスタンスを生成
           var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

           // geocoder.geocode()メソッドを実行 
           geocoder.geocode( { 'address': address}, function(results, status) {

             // ジオコーディングが成功した場合
             if (status == google.maps.GeocoderStatus.OK) {

               // google.maps.Map()コンストラクタに定義されているsetCenter()メソッドで
               // 変換した緯度・経度情報を地図の中心に表示
               map.setCenter(results[0].geometry.location);

               // 地図上に目印となるマーカーを設定います。
               // google.maps.Marker()コンストラクタにマーカーを設置するMapオブジェクトと
               // 変換した緯度・経度情報を渡してインスタンスを生成
               // →マーカー詳細
               var marker = new google.maps.Marker({
                 map: map,
                 position: results[0].geometry.location
               });


             // ジオコーディングが成功しなかった場合
             } else {
               console.log('Geocode was not successful for the following reason: ' + status);
             }
           
           });

         }

         return {

           getAddress: function() {
            
             // ボタンに指定したid要素を取得
             var button = document.getElementById("button");

             // ボタンが押された時の処理
             button.onclick = function() {

               // フォームに入力された住所情報を取得
               var address = document.getElementById("address").value;
               
               // 取得した住所を引数に指定してcodeAddress()関数を実行
               codeAddress(address);

             }
             
           }

         };

       })();

       getMap.getAddress();

      </script>
    </form>

<!-- 地図を表示させる要素 -->
<div id="map-canvas" style="width:100%; height:100%"></div>
</body>


</html>